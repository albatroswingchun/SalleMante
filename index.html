<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Loupe Zoom x0.85</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      cursor: none;
    }
    .img-zoom-container {
      position: relative;
      width: 100vw;
      height: 100vh;
    }
    #myimage {
      position: absolute;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: 1;
    }
    .img-zoom-lens {
      position: absolute;
      width: 150px;
      height: 150px;
      border-radius: 50%;
      overflow: hidden;
      pointer-events: none;
      z-index: 10;
      border: 2px solid white;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.4);
    }
    .zoomed-image {
      position: absolute;
      transform-origin: top left;
      pointer-events: none;
    }
    .loupe-frame {
      position: absolute;
      width: 300px;
      height: 300px;
      pointer-events: none;
      z-index: 20;
      background-image: url('https://i.imgur.com/4ZyM16h.png');
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
    }
  </style>
</head>
<body>

<div class="img-zoom-container">
  <img id="myimage" src="https://i.imgur.com/nZ8nfXg.png" alt="Image Zoom">
  <div id="lens" class="img-zoom-lens">
    <img id="zoomed" class="zoomed-image" src="https://i.imgur.com/nZ8nfXg.png" alt="zoom">
  </div>
  <div id="loupeframe" class="loupe-frame"></div>
</div>

<script>
function imageZoom() {
  const img = document.getElementById("myimage");
  const lens = document.getElementById("lens");
  const zoomed = document.getElementById("zoomed");
  const frame = document.getElementById("loupeframe");

  const lensSize = 150;
  const zoomFactor = 2;
  const motionFactor = 0.85;
  const frameOffsetX = 35;
  const frameOffsetY = 55;

  function getCursorPos(e) {
    const rect = img.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    return { x, y };
  }

  function moveLens(e) {
    e.preventDefault();
    const pos = getCursorPos(e);

    const lensX = pos.x - lensSize / 2;
    const lensY = pos.y - lensSize / 2;
    lens.style.left = lensX + "px";
    lens.style.top = lensY + "px";

    const centerX = img.offsetWidth / 2;
    const centerY = img.offsetHeight / 2;
    const dx = pos.x - centerX;
    const dy = pos.y - centerY;

    zoomed.style.transform = `scale(${zoomFactor})`;
    zoomed.style.left = -(centerX + dx * motionFactor - lensSize / 2) * zoomFactor + "px";
    zoomed.style.top  = -(centerY + dy * motionFactor - lensSize / 2) * zoomFactor + "px";

    frame.style.left = (lensX + frameOffsetX) + "px";
    frame.style.top  = (lensY + frameOffsetY) + "px";
  }

  function attachListeners() {
    ["mousemove", "touchmove"].forEach(event => {
      img.addEventListener(event, moveLens);
      lens.addEventListener(event, moveLens);
    });
  }

  attachListeners();
}

window.onload = imageZoom;
</script>

</body>
</html>
